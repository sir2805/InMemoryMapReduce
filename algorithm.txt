1) join_map_revert над первым файлом вернет последовательность B\t1\tA 
таким образом можно будет отличить А от С
2) join_map_append просто добавит второй файл к B\t1\tA
3) join_reduce_joiner обьединит все одинаковые B и все, что к ним относится соответственно.
Получится последовательность B\tC1\t\1\tA1...
4) join_map_final последовательно читает записи B\tC1\t\1\tA1... и разбивает их на A\t\B\tC
Для определения A используется флаг \t1. Разбиение идет только если есть все 3 ключа (А, В, С)
Для этого входная строка разбивается на 3: В, A1\t\A2\t... , C1\t\C2\t...
Затем цикл по A(A разбивается по \t) и для каждого А цикл по С и cout << Ai\tB\tCj
